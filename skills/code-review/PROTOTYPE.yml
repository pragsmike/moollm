# Code Review Skill Prototype
# Systematic code analysis with evidence collection

skill:
  name: "code-review"
  tier: 2
  description: "Conduct thorough code reviews with evidence"
  requires: ["file-read", "terminal-execute"]

inputs:
  review_name:
    type: string
    required: true
    description: "Name/identifier for this review"
    
  files:
    type: list
    required: true
    description: "Files to review"
    items:
      type: path
      
  focus:
    type: list
    required: false
    default: ["security", "correctness", "maintainability"]
    description: "Review focus areas"
    values: ["security", "correctness", "maintainability", "performance", "style"]

outputs:
  review_yml:
    type: path
    description: "Structured review data"
    
  review_md:
    type: path
    description: "Formatted review document"
    
  recommendation:
    type: enum
    values: ["approve", "request_changes", "comment"]

working_set:
  hot:
    - "REVIEW.yml"
    - "REVIEW.md"
  warm:
    - "Files under review"

finding_severities:
  blocking:
    symbol: "üö´"
    description: "Must fix before merge"
    action: "Request changes"
    
  important:
    symbol: "‚ö†Ô∏è"
    description: "Should fix or explain"
    action: "Request changes"
    
  minor:
    symbol: "üí°"
    description: "Nice to fix"
    action: "Comment only"
    
  praise:
    symbol: "üéâ"
    description: "Good work!"
    action: "Celebrate"

finding_types:
  - security
  - correctness
  - performance
  - maintainability
  - style
  - documentation

checklist:
  security:
    - "Input validation"
    - "Output encoding"
    - "Authentication checks"
    - "Authorization checks"
    - "Sensitive data handling"
    - "Injection vulnerabilities"
    - "Timing attacks"
    
  correctness:
    - "Logic errors"
    - "Edge cases handled"
    - "Null/undefined handling"
    - "Error handling"
    - "Race conditions"
    - "Resource cleanup"
    
  maintainability:
    - "Code clarity"
    - "Appropriate comments"
    - "Consistent naming"
    - "DRY (no duplication)"
    - "Single responsibility"
    - "Testability"
    
  performance:
    - "Algorithmic complexity"
    - "Memory usage"
    - "Database queries"
    - "Caching considerations"
    - "Unnecessary operations"

verification_commands:
  tests:
    common:
      - "npm test"
      - "pytest"
      - "go test ./..."
      - "cargo test"
      
  linters:
    common:
      - "npm run lint"
      - "flake8"
      - "golangci-lint run"
      - "cargo clippy"

lifecycle:
  setup:
    - "Create REVIEW.yml"
    - "List target files"
    - "Define focus areas"
    
  overview:
    - "List all files"
    - "Read PR/commit description"
    - "Note initial impressions"
    
  deep_review:
    - "Read each file"
    - "Check against criteria"
    - "Note findings"
    - "Run relevant checks"
    
  verification:
    - "Run tests"
    - "Run linters"
    - "Check regressions"
    
  synthesize:
    - "Compile findings"
    - "Prioritize issues"
    - "Generate REVIEW.md"
    - "State recommendation"
