# This is what happens when you apply this card to itself. âœ¨ğŸª©ğŸŒˆ
card:
  name: worm-emoji-fordite  # ğŸ¨ğŸª©
  type: [worm, cursor, example]
  tier: 1
  invoke_when: ["decorate comments with emojis", "run repeatedly for layers"]
  advertisement_names:
    - RUN-WORM
    - EAT-COMMENTS
    - APPEND-EMOJIS
  prototypes:
    - skills/worm/CARD.yml
  related:
    - skills/worm
    - skills/data-flow
    - skills/advertisement
  tags: [moollm, worm, emoji, fordite, comments]
  description: |
    Emoji Fordite Worm: crawls a target file, finds comment lines, and appends
    emojis (avoids exact same emoji twice in a row). Running repeatedly creates
    layered emoji bands like fordite. ğŸ†ğŸŒ€ğŸ’œ

state:
  head: "{{target|.}}"
  tail: "{{target|.}}"
  # Extended palette for maximal chromatic fordite layers
  emoji_palette:
    - "âœ¨"  # sparkle
    - "ğŸª©"  # disco
    - "ğŸ¨"  # palette
    - "ğŸŒˆ"  # rainbow
    - "ğŸ’«"  # swirl
    - "ğŸª"  # planet
    - "ğŸ§¡"  # heart
    - "ğŸ’œ"  # heart
    - "ğŸ’"  # gem
    - "ğŸ”¥"  # fire
    - "ğŸ’§"  # drop
    - "ğŸŒŠ"  # wave
    - "ğŸ­"  # candy
    - "ğŸ¥"  # swirl cake
    - "ğŸŒ€"  # vortex
    - "ğŸŒ¸"  # blossom
    - "ğŸ"  # leaf
    - "ğŸ¦‹"  # butterfly
    - "â­"  # star
    - "âš¡"  # bolt
    - "ğŸ†"  # fireworks
    - "ğŸ§¬"  # helix
    - "ğŸ›°ï¸" # satellite
    - "ğŸª„"  # wand
    - "ğŸª¶"  # feather
    - "ğŸ›¸"  # ufo
    - "ğŸŒŒ"  # milky way
    - "ğŸ‰"  # watermelon
    - "ğŸ¥‘"  # avocado
    - "ğŸ§Š"  # ice
    - "ğŸŒ™"  # moon
    - "â˜„ï¸"  # comet
    - "ğŸ¥‡"  # medal
    - "ğŸ“€"  # disc
    - "ğŸ’ "  # diamond shape
    - "ğŸ”®"  # crystal ball
    - "ğŸ§¿"  # nazar
  max_per_pass: 2
  avoid_consecutive: true
  emit_dir: ".moollm/worm-out"

advertisements:
  RUN-WORM:
    effect: "Scan target file comments and append emojis"
    delegate:
      method: RUN-WORM
      params:
        target: "{{target|.}}"
  EAT-COMMENTS:
    effect: "Read comment lines into buffer"
    delegate:
      method: EAT-COMMENTS
      params:
        target: "{{target|.}}"
  APPEND-EMOJIS:
    effect: "Append 1-2 emojis from palette to each comment line (no immediate repeats)"
    delegate:
      method: APPEND-EMOJIS
      params:
        target: "{{target|.}}"

methods:
  RUN-WORM:
    description: "One-pass comment decoration"
    parameters:
      target: "File to decorate"
    output: chat
    effect: "Reads comments, appends emojis (respecting avoid_consecutive)"

  EAT-COMMENTS:
    description: "Load comment lines into buffer"
    parameters:
      target: "File to scan"
    output: chat
    effect: "Buffers comment lines for emoji pass"

  APPEND-EMOJIS:
    description: "Append emojis to comment lines"
    parameters:
      target: "File to modify"
    output: chat + file
    effect: "Appends emojis from palette; avoids same emoji twice in a row on a line; can be rerun to build layers"

flavor:
  text: |
    "Layered emoji fordite: every pass adds a new colorful stratum to your comments.
    Run it repeatedly over this file (meta!) to build prismatic bands that reflect
    how each line feels in context."

# emoji_layer (meta self-pass, kept as comments to avoid schema impact)
# card header: ğŸ¨ğŸª©ğŸŒˆ
# invoke/ads: ğŸ’«ğŸªâš¡
# palette: ğŸ­ğŸ§¿ğŸ’ğŸŒ™â˜„ï¸
# buffer/payload: ğŸŒŠğŸŒ€
# run/eat/append: ğŸª„âœ¨
# flavor: ğŸ¦‹ğŸŒ¸ğŸ†
