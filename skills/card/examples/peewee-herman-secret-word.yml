card:
  name: peewee-herman-secret-word
  type: [card, sidecar, room-item]
  tier: 1
  invoke_when: ["room enters", "object inspected", "game starts"]
  advertisement_names:
    - SECRET-WORD        # public ad; triggers the bit
    - SET-SECRET-WORD    # exported as generic ad
    - SET-REACTION       # exported as generic ad
    - TELL-SECRET-WORD   # exported ad to reveal (politely)
    - TELL-REACTION      # exported ad to reveal the current reaction
  prototypes:
    - skills/secret-word # generic secret-word card (parent)
  related:
    - skills/card
  tags: [moollm, example, pee-wee, secret-word, game]
  description: |
    A room-local secret word card (tribute to Pee-Wee Herman). Drop this in a room to
    put the secret word in play. Inherits generic behavior from the base
    secret-word card; adds the specific word and a localized reaction.

# The specific word (instance data)
secret_word: "MOOLLM"      # the word that triggers the reaction
reaction: "AUGH! Everyone screams when they hear it!"  # room-local response

advertisements:
  SECRET-WORD:
    synonyms: [THE-SECRET-WORD] # the value of secret_word, not literally THE-SECRET-WORD
    score: 90
    condition: "Someone says the secret word"
    effect: "Trigger the Pee-wee scream and any inherited effects"
    delegate:
      method: TRIGGER-SECRET-WORD
      params:
        word: "{{secret_word}}"
      dispatch:
        prefix: TRIGGER-SECRET-WORD
        variants: []

  TELL-SECRET-WORD:
    synonyms: [REVEAL-SECRET-WORD]
    score: 70
    condition: "Someone asks politely and says PLEASE"
    effect: "Share the current secret word (no scream)."
    delegate:
      method: TELL-SECRET-WORD
      params: {}

  TELL-REACTION:
    synonyms: [SHOW-REACTION]
    score: 60
    condition: "Asked about the reaction"
    effect: "Share the current reaction text."
    delegate:
      method: TELL-REACTION
      params: {}

tools:
  required: []
  optional: []

methods:
  TRIGGER-SECRET-WORD:
    description: "Fire the secret word reaction (room-local)."
    parameters: { word: "What was said" }
    output: chat
    effect: "If the word matches, emit the reaction (screaming!)."

  SET-SECRET-WORD:
    description: "Change the secret word at runtime."
    parameters:
      new_word: "The new secret word"
      reaction: "Optional new reaction"
    output: chat
    effect: "Updates secret_word (and reaction if provided) for this instance."

  SET-REACTION:
    description: "Change the reaction without changing the word."
    parameters:
      reaction: "New reaction text"
    output: chat
    effect: "Updates the reaction for this instance."

  TELL-SECRET-WORD:
    description: "Reveal the secret word when asked politely (with PLEASE)."
    parameters: { please: "Literal token 'PLEASE' required" }
    output: chat
    effect: "If request includes PLEASE, returns the secret word without triggering the scream."

  TELL-REACTION:
    description: "Reveal the current reaction (not secret)."
    parameters: {}
    output: chat
    effect: "Returns the reaction text."
