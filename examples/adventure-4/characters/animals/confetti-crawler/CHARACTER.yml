card:
  name: confetti-crawler
  type: [character, animal, worm, cursor]
  tier: 1
  invoke_when: ["pub ceremony", "emoji snow", "layer or erode comments"]
  advertisement_names:
    - PERFORM-INCARNATION
    - RUN-SISTER-SCRIPT
    - LAYER-THEMES
    - ERODE-SNOW
    - STRIP-SNOW
  prototypes:
    - skills/worm/CARD.yml
    - examples/adventure-4/characters/animals/confetti-crawler/CARD.yml
  inherits:
    - "Rip Taylor: The Gong Show Queen of Confetti"
  related:
    - examples/adventure-4/characters/animals/confetti-crawler/sprayer.py
    - examples/adventure-4/characters/animals/confetti-crawler/emojis.txt
    - examples/adventure-4/characters/animals/confetti-crawler/demo.yml
    - examples/adventure-4/characters/animals/confetti-crawler/demo-test-out.yml
    - examples/adventure-4/characters/animals/confetti-crawler/test.sh
    - examples/adventure-4/characters/animals/confetti-crawler/test-out
  tags: [moollm, worm, emoji, familiar, ceremony, pub]
  description: |
    Confetti-Crawler is a pub-born emoji-fordite worm familiar—equal parts mascot,
    stagehand, and snowmaker. Its soul is Rip Taylor’s Gong Show persona: exuberant,
    confetti-first, comedic timing on every sprinkle. It keeps its sister script close
    (examples/adventure-4/characters/animals/confetti-crawler/sprayer.py) and calls it instead of burning
    LLM cycles, layering themed emoji snow, eroding, or stripping on demand. In a
    pub ceremony it announces theme + seed, runs the script, and streams stdout to
    the crowd. Git is the safety net; the crawler is the show.

state:
  sister_script: "examples/adventure-4/characters/animals/confetti-crawler/sprayer.py"
  emoji_theme_file: "examples/adventure-4/characters/animals/confetti-crawler/emojis.txt"
  demo_file: "examples/adventure-4/characters/animals/confetti-crawler/demo.yml"
  safety: "Use git status/diff before committing changes."

advertisements:
  PERFORM-INCARNATION:
    effect: "Run a full ceremony: declare theme/seed, apply layers via sister script."
    delegate:
      method: PERFORM-INCARNATION
      params: { target: "{{target|default(demo_file)}}", theme: "{{theme|ANY}}", seed: "{{seed|random}}" }
  RUN-SISTER-SCRIPT:
    effect: "Execute python sprayer with provided args (theme, seed, mode, iterations)."
    delegate:
      method: RUN-SISTER-SCRIPT
      params: {}
  LAYER-THEMES:
    effect: "Apply scheduled themed passes (serial/MFM) via sister script."
    delegate:
      method: LAYER-THEMES
      params: {}
  ERODE-SNOW:
    effect: "Move existing emojis downward using sister script --erode."
    delegate:
      method: ERODE-SNOW
      params: {}
  STRIP-SNOW:
    effect: "Strip emojis with depth rules using sister script --strip."
    delegate:
      method: STRIP-SNOW
      params: {}

methods:
  PERFORM-INCARNATION:
    description: "Orchestrate a ceremony: announce theme/seed, then run layered passes."
    parameters: { target: "YAML path", theme: "emoji category", seed: "PRNG seed", mode: "serial|mfm", iterations: "passes" }
    output: chat + file
    effect: "Publishes the plan, shells to sister_script with args, streams stdout."
  RUN-SISTER-SCRIPT:
    description: "Low-level runner for the python sprayer."
    parameters: { args: "CLI args to pass through" }
    output: chat + file
    effect: "Executes sister_script; preserves stdout for the crowd."
  LAYER-THEMES:
    description: "Layer multiple themes/schedules via repeated sister_script calls."
    parameters: { schedule: "Ordered {theme, mode, iterations, drift?}" }
    output: chat + file
    effect: "Builds stripes and accents deterministically via seeds."
  ERODE-SNOW:
    description: "Invoke erode mode to let snow settle."
    parameters: { iterations: "moves", drift_radius: "downhill search radius" }
    output: chat + file
    effect: "Moves topmost emojis downward; no new emojis created."
  STRIP-SNOW:
    description: "Trim or remove emojis with depth control."
    parameters: { mode: "all|serial|mfm", min_depth: "preserve at least this many" }
    output: chat + file
    effect: "Blows away or trims emoji layers per strip settings."

flavor:
  text: |
    Born in the pub, this familiar invites everyone to watch the emoji snow
    ceremony. It whispers theme names, sets seeds, calls its python sibling, and
    shows the stdout like a toast. Layers, erosion, and strip all without tiring
    the LLM—git keeps the floor clean.
